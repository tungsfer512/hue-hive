{"version":3,"file":"editor-bundle-a2a4f8506cb55bb7.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3iBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACvmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./desktop/core/src/desktop/js/apps/editor/EditorViewModel.js","webpack:///./desktop/core/src/desktop/js/apps/editor/app.js","webpack:///./desktop/core/src/desktop/js/apps/editor/components/ko.paginator.js","webpack:///./desktop/core/src/desktop/js/apps/editor/components/ko.savedQueries.js","webpack:///./desktop/core/src/desktop/js/apps/editor/notebook.js"],"sourcesContent":["function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n// Licensed to Cloudera, Inc. under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  Cloudera, Inc. licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport $ from 'jquery';\nimport * as ko from 'knockout';\nimport komapping from 'knockout.mapping';\nimport apiHelper from \"../../api/apiHelper\";\nimport { ACTIVE_SNIPPET_CONNECTOR_CHANGED_EVENT, GET_ACTIVE_SNIPPET_CONNECTOR_EVENT } from \"./events\";\nimport Notebook from \"./notebook\";\nimport ChartTransformers from \"../notebook/chartTransformers\";\nimport { CONFIG_REFRESHED_TOPIC, GET_KNOWN_CONFIG_TOPIC } from 'config/events';\nimport { findEditorConnector, getLastKnownConfig } from 'config/hueConfig';\nimport { GLOBAL_INFO_TOPIC } from 'reactComponents/AlertComponent/events';\nimport huePubSub from 'utils/huePubSub';\nimport { getFromLocalStorage, setInLocalStorage } from 'utils/storageUtils';\nimport UUID from 'utils/string/UUID';\nimport _changeURL from 'utils/url/changeURL';\nimport changeURLParameter from 'utils/url/changeURLParameter';\nimport getParameter from 'utils/url/getParameter';\nvar EditorViewModel = /*#__PURE__*/function () {\n  function EditorViewModel(options, CoordinatorEditorViewModel, RunningCoordinatorModel) {\n    var _this = this;\n    _classCallCheck(this, EditorViewModel);\n    // eslint-disable-next-line no-restricted-syntax\n    console.log('Editor v2 enabled.');\n    this.snippetViewSettings = options.snippetViewSettings;\n    this.URLS = {\n      editor: '/hue/editor',\n      notebook: '/hue/notebook',\n      report: '/hue/dashboard/new_search?engine=report'\n    };\n    this.huePubSubId = options.huePubSubId || 'editor';\n    this.user = options.user;\n    this.userId = options.userId;\n    this.suffix = options.suffix;\n    this.isNotificationManager = ko.observable(!!options.is_notification_manager);\n    this.selectedNotebook = ko.observable();\n    this.firstSnippet = ko.pureComputed(function () {\n      return _this.selectedNotebook() && _this.selectedNotebook().snippets()[0];\n    });\n    this.editorMode = ko.observable(options.mode === 'editor');\n    this.config = ko.observable();\n    this.sharingEnabled = ko.pureComputed(function () {\n      return _this.config() && (_this.config().hue_config.is_admin || _this.config().hue_config.enable_sharing);\n    });\n    huePubSub.publish(GET_KNOWN_CONFIG_TOPIC, this.config);\n    huePubSub.subscribe(CONFIG_REFRESHED_TOPIC, this.config);\n    this.activeConnector = ko.pureComputed(function () {\n      if (_this.editorMode()) {\n        var snippet = _this.getActiveSnippet();\n        if (snippet) {\n          if (!snippet.connector()) {\n            console.warn('Snippet connector is empty');\n          }\n          return snippet.connector();\n        }\n      } else if (_this.config() && _this.config().app_config && _this.config().app_config.editor) {\n        var interpreters = _this.config().app_config.editor.interpreters;\n        return interpreters.find(function (interpreter) {\n          return interpreter.dialect === 'notebook';\n        });\n      }\n    });\n    this.editorType = ko.pureComputed(function () {\n      return _this.activeConnector() && _this.activeConnector().id;\n    });\n    this.editorTitle = ko.pureComputed(function () {\n      return _this.activeConnector() && _this.activeConnector().displayName;\n    });\n    this.editorIcon = ko.pureComputed(function () {\n      var _this$activeConnector;\n      var dialect = (_this$activeConnector = _this.activeConnector()) === null || _this$activeConnector === void 0 ? void 0 : _this$activeConnector.dialect;\n      return window.ENABLE_UNIFIED_ANALYTICS && dialect === 'hive' ? 'impala' : dialect || _this.editorType();\n    });\n    this.activeConnector.subscribe(function (connector) {\n      if (connector) {\n        if (getParameter('type') !== connector.id) {\n          changeURLParameter('type', connector.id);\n        }\n        _this.notifyDialectChange(connector.dialect, connector.is_sql);\n      }\n    });\n    this.lastNotifiedDialect = undefined;\n    this.combinedContent = ko.observable();\n    this.isPresentationModeEnabled = ko.pureComputed(function () {\n      return _this.selectedNotebook() && _this.selectedNotebook().snippets().length === 1 && _this.selectedNotebook().snippets()[0].isSqlDialect();\n    });\n    this.bottomExpanded = ko.observable(false);\n    this.topExpanded = ko.observable(false);\n    this.bottomExpanded.subscribe(function (newVal) {\n      if (newVal) {\n        if (_this.topExpanded()) {\n          _this.topExpanded(false);\n        }\n        huePubSub.publish('both.assists.hide', true);\n      } else {\n        huePubSub.publish('both.assists.revert', true);\n      }\n    });\n    this.topExpanded.subscribe(function (newVal) {\n      if (newVal) {\n        if (_this.bottomExpanded()) {\n          _this.bottomExpanded(false);\n        }\n        huePubSub.publish('left.assist.hide', true);\n      } else {\n        huePubSub.publish('both.assists.revert', true);\n      }\n    });\n    this.isPresentationMode = ko.pureComputed(function () {\n      return _this.selectedNotebook() && _this.selectedNotebook().isPresentationMode();\n    });\n    this.isHidingCode = ko.pureComputed(function () {\n      return _this.selectedNotebook() && _this.selectedNotebook().isHidingCode();\n    });\n    this.successUrl = ko.observable(options.success_url); // Deprecated\n    this.isSqlAnalyzerEnabled = ko.observable(options.is_optimizer_enabled);\n    this.isNavigatorEnabled = ko.observable(options.is_navigator_enabled);\n    this.CoordinatorEditorViewModel = CoordinatorEditorViewModel; // TODO: Remove usage of global variables\n    this.RunningCoordinatorModel = RunningCoordinatorModel; // TODO: Remove usage of global variables\n\n    // Saved query or history but history coming from a saved query\n    this.canSave = ko.pureComputed(function () {\n      return _this.selectedNotebook() && _this.selectedNotebook().canWrite() && (_this.selectedNotebook().isSaved() || _this.selectedNotebook().isHistory() && _this.selectedNotebook().parentSavedQueryUuid());\n    });\n    this.ChartTransformers = ChartTransformers;\n    this.isEditing = ko.observable(false);\n    this.isEditing.subscribe(function () {\n      $(document).trigger('editingToggled');\n    });\n    this.assistAvailable = ko.observable(options.assistAvailable);\n    this.assistWithoutStorage = ko.observable(false);\n    this.isLeftPanelVisible = ko.observable(getFromLocalStorage('assist.assist_panel_visible', true));\n    this.isLeftPanelVisible.subscribe(function (val) {\n      if (!_this.assistWithoutStorage()) {\n        setInLocalStorage('assist.assist_panel_visible', val);\n      }\n    });\n    this.isRightPanelAvailable = ko.observable(options.assistAvailable && window.HAS_SQL_ANALYZER);\n    this.isRightPanelVisible = ko.observable(getFromLocalStorage('assist.right_assist_panel_visible', true));\n    this.isRightPanelVisible.subscribe(function (val) {\n      if (!_this.assistWithoutStorage()) {\n        setInLocalStorage('assist.right_assist_panel_visible', val);\n      }\n    });\n    huePubSub.subscribe('assist.highlight.risk.suggestions', function () {\n      if (_this.isRightPanelAvailable() && !_this.isRightPanelVisible()) {\n        _this.isRightPanelVisible(true);\n      }\n    });\n    huePubSub.subscribe(GET_ACTIVE_SNIPPET_CONNECTOR_EVENT, function (callback) {\n      _this.withActiveSnippet(function (activeSnippet) {\n        callback(activeSnippet.connector());\n      });\n    }, this.huePubSubId);\n    huePubSub.subscribe('save.snippet.to.file', function () {\n      _this.withActiveSnippet(function (activeSnippet) {\n        var data = {\n          path: activeSnippet.statementPath(),\n          contents: activeSnippet.statement()\n        };\n        var options = {\n          successCallback: function successCallback(result) {\n            if (result && result.exists) {\n              huePubSub.publish(GLOBAL_INFO_TOPIC, {\n                message: result.path + ' saved successfully.'\n              });\n            }\n          }\n        };\n        apiHelper.saveSnippetToFile(data, options);\n      });\n    }, this.huePubSubId);\n    huePubSub.subscribe('sql.context.pin', function (contextData) {\n      _this.withActiveSnippet(function (activeSnippet) {\n        contextData.tabId = 'context' + activeSnippet.pinnedContextTabs().length;\n        activeSnippet.pinnedContextTabs.push(contextData);\n        activeSnippet.currentQueryTab(contextData.tabId);\n      });\n    }, this.huePubSubId);\n    huePubSub.subscribe('assist.database.set', function (entry) {\n      _this.withActiveSnippet(function (activeSnippet) {\n        activeSnippet.handleAssistSelection(entry);\n      });\n    }, this.huePubSubId);\n    huePubSub.subscribe('assist.database.selected', function (entry) {\n      _this.withActiveSnippet(function (activeSnippet) {\n        activeSnippet.handleAssistSelection(entry);\n      });\n    }, this.huePubSubId);\n    this.availableSnippets = komapping.fromJS(options.languages);\n  }\n  return _createClass(EditorViewModel, [{\n    key: \"changeURL\",\n    value: function changeURL(url) {\n      if (!this.isNotificationManager()) {\n        _changeURL(url);\n      }\n    }\n  }, {\n    key: \"displayCombinedContent\",\n    value: function displayCombinedContent() {\n      if (!this.selectedNotebook()) {\n        this.combinedContent('');\n      } else {\n        var statements = '';\n        this.selectedNotebook().snippets().forEach(function (snippet) {\n          if (snippet.statement()) {\n            if (statements) {\n              statements += '\\n\\n';\n            }\n            statements += snippet.statement();\n          }\n        });\n        this.combinedContent(statements);\n      }\n      $('#editorCombinedContentModal').modal('show');\n    }\n  }, {\n    key: \"getSnippetName\",\n    value: function getSnippetName(snippetType) {\n      var availableSnippets = this.availableSnippets();\n      for (var i = 0; i < availableSnippets.length; i++) {\n        if (availableSnippets[i].dialect() === snippetType) {\n          return availableSnippets[i].name();\n        }\n      }\n      return '';\n    }\n  }, {\n    key: \"getSnippetViewSettings\",\n    value: function getSnippetViewSettings(snippetType) {\n      if (this.snippetViewSettings[snippetType]) {\n        return this.snippetViewSettings[snippetType];\n      }\n      return this.snippetViewSettings[\"default\"];\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var editorId;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              editorId = getParameter('editor');\n              if (!editorId) {\n                _context.next = 6;\n                break;\n              }\n              _context.next = 4;\n              return this.openNotebook(editorId);\n            case 4:\n              _context.next = 18;\n              break;\n            case 6:\n              if (!(getParameter('gist') !== '' || getParameter('type') !== '')) {\n                _context.next = 11;\n                break;\n              }\n              _context.next = 9;\n              return this.newNotebook(getParameter('type'));\n            case 9:\n              _context.next = 18;\n              break;\n            case 11:\n              if (!(getParameter('editor') !== '')) {\n                _context.next = 16;\n                break;\n              }\n              _context.next = 14;\n              return this.openNotebook(getParameter('editor'));\n            case 14:\n              _context.next = 18;\n              break;\n            case 16:\n              _context.next = 18;\n              return this.newNotebook();\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function init() {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }()\n  }, {\n    key: \"loadNotebook\",\n    value: function loadNotebook(notebookRaw, queryTab) {\n      var notebook = new Notebook(this, notebookRaw);\n      if (notebook.snippets().length > 0) {\n        huePubSub.publish('detach.scrolls', notebook.snippets()[0]);\n        notebook.selectedSnippet(notebook.snippets()[notebook.snippets().length - 1].dialect());\n        notebook.snippets().forEach(function (snippet) {\n          snippet.aceAutoExpand = false;\n          snippet.statement_raw.valueHasMutated();\n        });\n        if (queryTab) {\n          notebook.snippets()[0].currentQueryTab(queryTab);\n        }\n        if (notebook.isSaved()) {\n          notebook.snippets()[0].currentQueryTab('savedQueries');\n        }\n      }\n      this.selectedNotebook(notebook);\n      huePubSub.publish('check.job.browser');\n      huePubSub.publish('recalculate.name.description.width');\n    }\n  }, {\n    key: \"newNotebook\",\n    value: function () {\n      var _newNotebook = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(connectorId, callback, queryTab, blank) {\n        var _this2 = this;\n        var connector, connectors;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!connectorId) {\n                connectorId = getLastKnownConfig().default_sql_interpreter;\n              }\n              if (connectorId) {\n                connector = findEditorConnector(function (connector) {\n                  return connector.id === connectorId;\n                });\n              } else {\n                connectors = getLastKnownConfig().app_config.editor.interpreters;\n                if (connectors.length) {\n                  connector = connectors[0];\n                }\n              }\n              if (!connector) {\n                console.warn('No connector found for ID ' + connectorId);\n              } else {\n                huePubSub.publish(ACTIVE_SNIPPET_CONNECTOR_CHANGED_EVENT, connector);\n              }\n              return _context2.abrupt(\"return\", new Promise(function (resolve, reject) {\n                $.post('/notebook/api/create_notebook', {\n                  type: connectorId,\n                  directory_uuid: getParameter('directory_uuid'),\n                  gist: _this2.isNotificationManager() ? undefined : getParameter('gist'),\n                  blank: typeof blank !== 'undefined'\n                }).then(function (data) {\n                  _this2.loadNotebook(data.notebook);\n                  if (_this2.editorMode() && !_this2.isNotificationManager()) {\n                    var snippet = _this2.selectedNotebook().snippets().length === 0 ? _this2.selectedNotebook().newSnippet(connectorId) : _this2.selectedNotebook().snippets()[0];\n                    if (queryTab && ['queryHistory', 'savedQueries', 'queryBuilderTab'].indexOf(queryTab) > -1) {\n                      snippet.currentQueryTab(queryTab);\n                    }\n                    huePubSub.publish('detach.scrolls', _this2.selectedNotebook().snippets()[0]);\n                  }\n                  if (callback) {\n                    callback();\n                  }\n                  resolve();\n                })[\"catch\"](reject);\n              }));\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }));\n      function newNotebook(_x, _x2, _x3, _x4) {\n        return _newNotebook.apply(this, arguments);\n      }\n      return newNotebook;\n    }()\n  }, {\n    key: \"openNotebook\",\n    value: function () {\n      var _openNotebook = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(uuid, queryTab, skipUrlChange, callback) {\n        var docData, notebookRaw;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return apiHelper.fetchDocumentAsync({\n                uuid: uuid,\n                fetchContents: true,\n                dependencies: true\n              });\n            case 3:\n              docData = _context3.sent;\n              docData.data.dependents = docData.dependents;\n              docData.data.can_write = docData.user_perms.can_write;\n              notebookRaw = docData.data;\n              this.loadNotebook(notebookRaw, queryTab);\n              if (typeof skipUrlChange === 'undefined' && !this.isNotificationManager()) {\n                if (this.editorMode()) {\n                  if (!this.editorType()) {\n                    console.warn('Snippet connector type or dialect is empty');\n                  }\n                  this.changeURL(this.URLS.editor + '?editor=' + docData.document.id + '&type=' + this.editorType());\n                } else {\n                  this.changeURL(this.URLS.notebook + '?notebook=' + docData.document.id);\n                }\n              }\n              if (callback) {\n                callback();\n              }\n              _context3.next = 17;\n              break;\n            case 12:\n              _context3.prev = 12;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.error(_context3.t0);\n              _context3.next = 17;\n              return this.newNotebook();\n            case 17:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this, [[0, 12]]);\n      }));\n      function openNotebook(_x5, _x6, _x7, _x8) {\n        return _openNotebook.apply(this, arguments);\n      }\n      return openNotebook;\n    }()\n  }, {\n    key: \"notifyDialectChange\",\n    value: function notifyDialectChange(dialect) {\n      if (dialect && this.lastNotifiedDialect !== dialect) {\n        huePubSub.publish(ACTIVE_SNIPPET_CONNECTOR_CHANGED_EVENT, this.activeConnector());\n        this.lastNotifiedDialect = dialect;\n      }\n    }\n  }, {\n    key: \"prepareShareModal\",\n    value: function prepareShareModal() {\n      var selectedNotebookUuid = this.selectedNotebook() && this.selectedNotebook().uuid();\n      if (selectedNotebookUuid) {\n        huePubSub.publish('doc.show.share.modal', selectedNotebookUuid);\n      }\n    }\n  }, {\n    key: \"saveAsNotebook\",\n    value: function saveAsNotebook() {\n      this.selectedNotebook().id(null);\n      this.selectedNotebook().uuid(UUID());\n      this.selectedNotebook().parentSavedQueryUuid(null);\n      this.selectedNotebook().save(function () {\n        huePubSub.publish('assist.document.refresh');\n      });\n    }\n  }, {\n    key: \"saveNotebook\",\n    value: function () {\n      var _saveNotebook = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return this.selectedNotebook().save();\n            case 2:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function saveNotebook() {\n        return _saveNotebook.apply(this, arguments);\n      }\n      return saveNotebook;\n    }()\n  }, {\n    key: \"showContextPopover\",\n    value: function showContextPopover(field, event) {\n      var $source = $(event.target && event.target.nodeName !== 'A' ? event.target.parentElement : event.target);\n      var offset = $source.offset();\n      huePubSub.publish('context.popover.show', {\n        data: {\n          type: 'catalogEntry',\n          catalogEntry: field.catalogEntry\n        },\n        onSampleClick: field.value,\n        showInAssistEnabled: true,\n        sourceType: this.editorType(),\n        orientation: 'bottom',\n        defaultDatabase: 'default',\n        pinEnabled: false,\n        source: {\n          element: event.target,\n          left: offset.left,\n          top: offset.top - 3,\n          right: offset.left + $source.width() + 1,\n          bottom: offset.top + $source.height() - 3\n        }\n      });\n    }\n  }, {\n    key: \"showSessionPanel\",\n    value: function showSessionPanel() {\n      this.withActiveSnippet(function (snippet) {\n        huePubSub.publish('session.panel.show', snippet.dialect());\n      }, function () {\n        huePubSub.publish('session.panel.show');\n      });\n    }\n  }, {\n    key: \"getActiveSnippet\",\n    value: function getActiveSnippet() {\n      var notebook = this.selectedNotebook();\n      var foundSnippet;\n      if (notebook) {\n        if (notebook.snippets().length === 1) {\n          foundSnippet = notebook.snippets()[0];\n        } else {\n          notebook.snippets().some(function (snippet) {\n            if (snippet.inFocus()) {\n              foundSnippet = snippet;\n              return true;\n            }\n          });\n        }\n      }\n      return foundSnippet;\n    }\n  }, {\n    key: \"withActiveSnippet\",\n    value: function withActiveSnippet(callback, notFoundCallback) {\n      var foundSnippet = this.getActiveSnippet();\n      if (foundSnippet) {\n        callback(foundSnippet);\n      } else if (notFoundCallback) {\n        notFoundCallback();\n      }\n    }\n  }]);\n}();\nexport { EditorViewModel as default };","// Licensed to Cloudera, Inc. under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  Cloudera, Inc. licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as ko from 'knockout';\nimport $ from 'jquery';\nimport Clipboard from 'clipboard';\nimport 'jquery-mousewheel';\nimport \"../../ext/bootstrap-datepicker.min\";\nimport \"../../ext/jquery.hotkeys\";\nimport \"../../jquery/plugins/jquery.hdfstree\";\nimport { HIDE_GLOBAL_ALERTS_TOPIC } from 'reactComponents/AlertComponent/events';\nimport { registerHueWorkers } from 'sql/workers/hueWorkerHandler';\nimport huePubSub from 'utils/huePubSub';\nimport I18n from \"../../utils/i18n\";\nimport scrollbarWidth from 'utils/screen/scrollbarWidth';\nimport waitForRendered from 'utils/timing/waitForRendered';\nimport { HIDE_FIXED_HEADERS_EVENT, REDRAW_FIXED_HEADERS_EVENT, SHOW_GRID_SEARCH_EVENT, SHOW_NORMAL_RESULT_EVENT, REDRAW_CHART_EVENT, IGNORE_NEXT_UNLOAD_EVENT } from \"./events\";\nimport EditorViewModel from \"./EditorViewModel\";\nimport { DIALECT } from \"./snippet\";\nimport { SHOW_LEFT_ASSIST_EVENT } from \"../../ko/components/assist/events\";\nwindow.Clipboard = Clipboard;\nvar HUE_PUB_SUB_EDITOR_ID = 'editor';\nhuePubSub.subscribe('app.dom.loaded', function (app) {\n  if (app === 'editor') {\n    window.MAIN_SCROLLABLE = '.page-content';\n    var isLeftNavOpen = false;\n    huePubSub.subscribe('left.nav.open.toggle', function (val) {\n      isLeftNavOpen = val;\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('split.panel.resized', function () {\n      huePubSub.publish('recalculate.name.description.width');\n    }, HUE_PUB_SUB_EDITOR_ID);\n    var showHoverMsg = function showHoverMsg(e) {\n      var dt = null;\n      if (e) {\n        dt = e.dataTransfer;\n      }\n      if (!isLeftNavOpen && (!dt || dt.types && (dt.types.indexOf ? dt.types.indexOf('Files') !== -1 : dt.types.contains('Files')))) {\n        $(window.EDITOR_BINDABLE_ELEMENT).find('.hoverMsg').removeClass('hide');\n      }\n    };\n    var hideHoverMsg = function hideHoverMsg(vm) {\n      if (vm.editorMode()) {\n        $(window.EDITOR_BINDABLE_ELEMENT).find('.hoverText').html(I18n('Drop a SQL file here'));\n      } else {\n        $(window.EDITOR_BINDABLE_ELEMENT).find('.hoverText').html(I18n('Drop iPython/Zeppelin notebooks here'));\n      }\n      $(window.EDITOR_BINDABLE_ELEMENT).find('.hoverMsg').addClass('hide');\n    };\n    if (ko.options) {\n      ko.options.deferUpdates = true;\n    }\n    var viewModel;\n    var replaceAce = function replaceAce(content) {\n      var snip = viewModel.selectedNotebook().snippets()[0];\n      if (snip) {\n        snip.statement_raw(content);\n        snip.result.statements_count(1);\n        snip.ace().setValue(content, 1);\n        snip.result.statement_range({\n          start: {\n            row: 0,\n            column: 0\n          },\n          end: {\n            row: 0,\n            column: 0\n          }\n        });\n        snip.ace()._emit('focus');\n      }\n      hideHoverMsg(viewModel);\n      huePubSub.publish(REDRAW_FIXED_HEADERS_EVENT);\n    };\n    window.replaceAce = replaceAce;\n\n    // Drag and drop iPython / Zeppelin notebooks\n    if (window.FileReader) {\n      var aceChecks = 0;\n      var addAce = function addAce(content, snippetType) {\n        var snip = viewModel.selectedNotebook().addSnippet({\n          type: snippetType,\n          result: {}\n        }, true);\n        snip.statement_raw(content);\n        aceChecks++;\n        snip.checkForAce = window.setInterval(function () {\n          if (snip.ace()) {\n            window.clearInterval(snip.checkForAce);\n            aceChecks--;\n            if (aceChecks === 0) {\n              hideHoverMsg(viewModel);\n              huePubSub.publish(REDRAW_FIXED_HEADERS_EVENT);\n            }\n          }\n        }, 100);\n      };\n      var addMarkdown = function addMarkdown(content) {\n        var snip = viewModel.selectedNotebook().addSnippet({\n          type: 'markdown',\n          result: {}\n        }, true);\n        snip.statement_raw(content);\n      };\n      var addPySpark = function addPySpark(content) {\n        addAce(content, 'pyspark');\n      };\n      var addSql = function addSql(content) {\n        addAce(content, 'hive');\n      };\n      var addScala = function addScala(content) {\n        addAce(content, 'spark');\n      };\n      var parseExternalJSON = function parseExternalJSON(raw) {\n        try {\n          if (viewModel.editorMode()) {\n            replaceAce(raw);\n          } else {\n            var loaded = typeof raw == 'string' ? JSON.parse(raw) : raw;\n            if (loaded.nbformat) {\n              //ipython\n              var cells = [];\n              if (loaded.nbformat === 3) {\n                cells = loaded.worksheets[0].cells;\n              } else if (loaded.nbformat === 4) {\n                cells = loaded.cells;\n              }\n              cells.forEach(function (cell, cellCnt) {\n                window.setTimeout(function () {\n                  if (cell.cell_type === 'code') {\n                    if (loaded.nbformat === 3) {\n                      addPySpark($.isArray(cell.input) ? cell.input.join('') : cell.input);\n                    } else {\n                      addPySpark($.isArray(cell.source) ? cell.source.join('') : cell.source);\n                    }\n                  }\n                  if (cell.cell_type === 'heading') {\n                    var heading = $.isArray(cell.source) ? cell.source.join('') : cell.source;\n                    if (cell.level === 1) {\n                      heading += '\\n====================';\n                    } else if (cell.level === 2) {\n                      heading += '\\n--------------------';\n                    } else {\n                      heading = '### ' + heading;\n                    }\n                    addMarkdown(heading);\n                  }\n                  if (cell.cell_type === 'markdown') {\n                    addMarkdown($.isArray(cell.source) ? cell.source.join('') : cell.source);\n                  }\n                  if (cellCnt === cells.length - 1 && aceChecks === 0) {\n                    hideHoverMsg(viewModel);\n                  }\n                }, 10);\n              });\n            }\n            if (loaded.paragraphs) {\n              //zeppelin\n              if (loaded.name) {\n                viewModel.selectedNotebook().name(loaded.name);\n              }\n              loaded.paragraphs.forEach(function (paragraph) {\n                if (paragraph.text) {\n                  var content = paragraph.text.split('\\n');\n                  if (content[0].indexOf('%md') > -1) {\n                    content.shift();\n                    addMarkdown(content.join('\\n'));\n                  } else if (content[0].indexOf('%sql') > -1 || content[0].indexOf('%hive') > -1) {\n                    content.shift();\n                    addSql(content.join('\\n'));\n                  } else if (content[0].indexOf('%pyspark') > -1) {\n                    content.shift();\n                    addPySpark(content.join('\\n'));\n                  } else {\n                    if (content[0].indexOf('%spark') > -1) {\n                      content.shift();\n                    }\n                    addScala(content.join('\\n'));\n                  }\n                }\n              });\n            }\n          }\n        } catch (e) {\n          hideHoverMsg(viewModel);\n          replaceAce(raw);\n        }\n      };\n      var handleFileSelect = function handleFileSelect(evt) {\n        evt.stopPropagation();\n        evt.preventDefault();\n        var dt = evt.dataTransfer;\n        var files = dt.files;\n        if (files.length > 0) {\n          showHoverMsg();\n        } else {\n          hideHoverMsg(viewModel);\n        }\n        for (var i = 0, f; f = files[i]; i++) {\n          var reader = new FileReader();\n          reader.onload = function (file) {\n            return function (e) {\n              $('.hoverText').html(\"<i class='fa fa-spinner fa-spin'></i>\");\n              parseExternalJSON(e.target.result);\n            };\n          }(f);\n          reader.readAsText(f);\n        }\n      };\n      var handleDragOver = function handleDragOver(evt) {\n        evt.stopPropagation();\n        evt.preventDefault();\n        evt.dataTransfer.dropEffect = 'copy';\n      };\n      var dropZone = $(window.EDITOR_BINDABLE_ELEMENT)[0];\n      dropZone.addEventListener('dragenter', showHoverMsg, false);\n      dropZone.addEventListener('dragover', handleDragOver, false);\n      dropZone.addEventListener('drop', handleFileSelect, false);\n      var isDraggingOverText = false;\n      $(window.EDITOR_BINDABLE_ELEMENT).find('.hoverText').on('dragenter', function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        e.stopImmediatePropagation();\n        isDraggingOverText = true;\n      });\n      $(window.EDITOR_BINDABLE_ELEMENT).find('.hoverText').on('dragleave', function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        e.stopImmediatePropagation();\n        isDraggingOverText = false;\n      });\n      $(window.EDITOR_BINDABLE_ELEMENT).find('.hoverMsg').on('dragleave', function (e) {\n        if (!isDraggingOverText) {\n          hideHoverMsg(viewModel);\n        }\n      });\n    }\n    if (window.EDITOR_ENABLE_QUERY_SCHEDULING) {\n      viewModel = new EditorViewModel(window.EDITOR_VIEW_MODEL_OPTIONS, window.CoordinatorEditorViewModel, window.RunningCoordinatorModel);\n    } else {\n      viewModel = new EditorViewModel(window.EDITOR_VIEW_MODEL_OPTIONS);\n    }\n    ko.applyBindings(viewModel, $(window.EDITOR_BINDABLE_ELEMENT)[0]);\n    viewModel.init();\n    registerHueWorkers();\n    viewModel.selectedNotebook.subscribe(function (newVal) {\n      huePubSub.publish('selected.notebook.changed', newVal);\n    });\n    var wasBottomExpanded = false;\n    var isAssistAvailable = viewModel.assistAvailable();\n    var wasLeftPanelVisible = viewModel.isLeftPanelVisible();\n    var wasRightPanelVisible = viewModel.isRightPanelVisible();\n    var exitPlayerMode = function exitPlayerMode() {\n      if (!wasBottomExpanded) {\n        viewModel.selectedNotebook().isPresentationMode(false);\n      } else {\n        viewModel.bottomExpanded(false);\n      }\n      wasBottomExpanded = false;\n    };\n    viewModel.isLeftPanelVisible.subscribe(function (value) {\n      huePubSub.publish(REDRAW_FIXED_HEADERS_EVENT);\n    });\n    var ignoreNextUnload = false;\n    huePubSub.subscribe(IGNORE_NEXT_UNLOAD_EVENT, function () {\n      ignoreNextUnload = true;\n    });\n\n    // Close the notebook snippets when leaving the page\n    window.onbeforeunload = function (e) {\n      if (ignoreNextUnload) {\n        ignoreNextUnload = false;\n        return;\n      }\n      if (!viewModel.selectedNotebook().avoidClosing) {\n        viewModel.selectedNotebook().close();\n      }\n    };\n    $(window).data('beforeunload', window.onbeforeunload);\n    $('.preview-sample').css('right', 10 + scrollbarWidth() + 'px');\n    var saveKeyHandler = function saveKeyHandler() {\n      if (viewModel.canSave()) {\n        viewModel.saveNotebook();\n      } else {\n        $('#editorSaveAsModal').modal('show');\n      }\n    };\n    var newKeyHandler = function newKeyHandler() {\n      if (!viewModel.editorMode()) {\n        viewModel.selectedNotebook().newSnippet();\n      } else {\n        viewModel.newNotebook(viewModel.editorType(), null, viewModel.selectedNotebook() ? viewModel.selectedNotebook().snippets()[0].currentQueryTab() : null);\n      }\n    };\n    var initKeydownBindings = function initKeydownBindings() {\n      $(window).bind('keydown.editor', 'ctrl+s alt+s meta+s', function (e) {\n        e.preventDefault();\n        saveKeyHandler();\n        return false;\n      });\n      $(window).bind('keydown.editor', 'ctrl+shift+p alt+shift+p meta+shift+p', function (e) {\n        e.preventDefault();\n        huePubSub.publish('editor.presentation.toggle');\n        return false;\n      });\n      $(window).bind('keydown.editor', 'ctrl+e alt+e meta+e', function (e) {\n        e.preventDefault();\n        newKeyHandler();\n        return false;\n      });\n    };\n    if (document.location.href.indexOf('editor') >= 0) {\n      initKeydownBindings();\n    }\n    $(document).bind('keyup', function (e) {\n      if (e.keyCode === 191 && e.shiftKey && !$(e.target).is('input') && !$(e.target).is('textarea')) {\n        $('#helpModal' + window.EDITOR_SUFFIX).modal('show');\n      }\n      if (e.keyCode === 191 && !e.shiftKey && !$(e.target).is('input') && !$(e.target).is('textarea')) {\n        if (viewModel.editorMode() && viewModel.selectedNotebook().snippets()[0].currentQueryTab() === 'queryResults') {\n          e.preventDefault();\n          huePubSub.publish(SHOW_GRID_SEARCH_EVENT);\n          return false;\n        }\n      }\n    });\n    var initialResizePosition = 100;\n    var draggableHelper = function draggableHelper(el, e, ui, setSize) {\n      var _snippet = ko.dataFor(el.parents('.snippet')[0]);\n      var _cm = $('#snippet_' + _snippet.id()).data('editor');\n      var _newSize = _snippet.aceSize() + (ui.offset.top - initialResizePosition);\n      _cm.setSize('99%', _newSize);\n      if (setSize) {\n        _snippet.aceSize(_newSize);\n      }\n    };\n    var getDraggableOptions = function getDraggableOptions(minY) {\n      return {\n        axis: 'y',\n        start: function start(e, ui) {\n          initialResizePosition = ui.offset.top;\n          huePubSub.publish(HIDE_FIXED_HEADERS_EVENT);\n        },\n        drag: function drag(e, ui) {\n          draggableHelper($(this), e, ui);\n        },\n        stop: function stop(e, ui) {\n          draggableHelper($(this), e, ui, true);\n          huePubSub.publish(REDRAW_FIXED_HEADERS_EVENT);\n          ui.helper.first().removeAttr('style');\n        },\n        containment: [0, minY, 4000, minY + 400]\n      };\n    };\n    $('.resize-panel a').each(function () {\n      $(this).draggable(getDraggableOptions($(this).parents('.snippet').offset().top + 128));\n    });\n\n    // ======== PubSub ========\n\n    var splitDraggableTimeout = -1;\n    huePubSub.subscribe('split.draggable.position', function () {\n      window.clearTimeout(splitDraggableTimeout);\n      splitDraggableTimeout = window.setTimeout(function () {\n        huePubSub.publish(REDRAW_FIXED_HEADERS_EVENT);\n      }, 200);\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('app.gained.focus', function (app) {\n      if (app === 'editor') {\n        huePubSub.publish(REDRAW_FIXED_HEADERS_EVENT);\n        huePubSub.publish('hue.scrollleft.show');\n        viewModel.notifyDialectChange(viewModel.editorType(), viewModel.getSnippetViewSettings(viewModel.editorType()).sqlDialect);\n      }\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('current.query.tab.switched', function (tab) {\n      if (tab !== 'queryResults') {\n        $('.hue-datatable-search').hide();\n      }\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('editor.create.new', newKeyHandler, HUE_PUB_SUB_EDITOR_ID);\n    if (viewModel.isSqlAnalyzerEnabled()) {\n      if (window.SQL_ANALYZER_AUTO_UPLOAD_QUERIES) {\n        huePubSub.subscribe('editor.upload.query', function (query_id) {\n          viewModel.selectedNotebook().snippets()[0].uploadQuery(query_id);\n        }, HUE_PUB_SUB_EDITOR_ID);\n      }\n      if (window.SQL_ANALYZER_AUTO_UPLOAD_DDL) {\n        huePubSub.subscribe('editor.upload.table.stats', function (options) {\n          viewModel.selectedNotebook().snippets()[0].uploadTableStats(options);\n        }, HUE_PUB_SUB_EDITOR_ID);\n      }\n      if (window.SQL_ANALYZER_QUERY_HISTORY_UPLOAD_LIMIT !== 0) {\n        huePubSub.subscribe('editor.upload.history', function () {\n          viewModel.selectedNotebook().snippets()[0].uploadQueryHistory(5);\n        }, HUE_PUB_SUB_EDITOR_ID);\n      }\n    }\n    huePubSub.subscribe('get.selected.notebook', function () {\n      huePubSub.publish('set.selected.notebook', viewModel.selectedNotebook());\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe(SHOW_LEFT_ASSIST_EVENT, function () {\n      if (!viewModel.isLeftPanelVisible() && viewModel.assistAvailable()) {\n        viewModel.isLeftPanelVisible(true);\n      }\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('assist.set.manual.visibility', function () {\n      wasLeftPanelVisible = viewModel.isLeftPanelVisible();\n      wasRightPanelVisible = viewModel.isRightPanelVisible();\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('editor.presentation.operate.toggle', function (value) {\n      viewModel.isEditing(!viewModel.isEditing());\n      if (value) {\n        huePubSub.publish(HIDE_GLOBAL_ALERTS_TOPIC);\n        isAssistAvailable = viewModel.assistAvailable();\n        wasLeftPanelVisible = viewModel.isLeftPanelVisible();\n        wasRightPanelVisible = viewModel.isRightPanelVisible();\n        if (wasBottomExpanded) {\n          huePubSub.publish('both.assists.hide', true);\n        } else {\n          huePubSub.publish('right.assist.hide', true);\n        }\n        viewModel.assistWithoutStorage(true);\n        viewModel.assistAvailable(false);\n        viewModel.isLeftPanelVisible(true);\n        viewModel.isRightPanelVisible(false);\n        window.setTimeout(function () {\n          viewModel.assistWithoutStorage(false);\n        }, 0);\n        $('.navigator').hide();\n        $('.add-snippet').hide();\n\n        // if (window.BANNER_TOP_HTML) {\n        //   $('.main-content').attr('style', 'top: 31px !important');\n        // } else {\n        //   $('.main-content').css('top', '1px');\n        // }\n        window.setTimeout(function () {\n          huePubSub.publish(REDRAW_FIXED_HEADERS_EVENT);\n        }, 200);\n        $(window).bind('keydown', 'esc', exitPlayerMode);\n      } else {\n        huePubSub.publish(HIDE_FIXED_HEADERS_EVENT);\n        huePubSub.publish('both.assists.revert', true);\n        viewModel.assistWithoutStorage(true);\n        viewModel.isLeftPanelVisible(wasLeftPanelVisible);\n        viewModel.isRightPanelVisible(wasRightPanelVisible);\n        viewModel.assistAvailable(isAssistAvailable);\n        window.setTimeout(function () {\n          viewModel.assistWithoutStorage(false);\n        }, 0);\n        $('.navigator').show();\n        $('.add-snippet').show();\n        // if (window.BANNER_TOP_HTML) {\n        //   $('.main-content').css('top', '112px');\n        // } else {\n        //   $('.main-content').css('top', '74px');\n        // }\n        window.setTimeout(function () {\n          huePubSub.publish(REDRAW_FIXED_HEADERS_EVENT);\n        }, 200);\n        $(window).unbind('keydown', exitPlayerMode);\n      }\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('show.retry.modal', function (data) {\n      $('#editorRetryModal').modal('show');\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('hide.retry.modal', function (data) {\n      $('#editorRetryModal' + window.EDITOR_SUFFIX).modal('hide');\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('open.link', function (link) {\n      $(window).unbind('keydown.editor');\n      if (link.indexOf('editor') >= 0) {\n        initKeydownBindings();\n      }\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('editor.presentation.toggle', function () {\n      viewModel.selectedNotebook().isPresentationMode(!viewModel.isPresentationMode());\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('editor.save', saveKeyHandler, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('render.jqcron', function () {\n      if (typeof window.renderJqCron !== 'undefined') {\n        window.renderJqCron();\n      }\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('submit.popup.return', function (data) {\n      viewModel.selectedNotebook().viewSchedulerId(data.job_id);\n      $('.submit-modal-editor').modal('hide');\n      huePubSub.publish('show.jobs.panel', {\n        id: data.job_id,\n        \"interface\": data.type\n      });\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('jobbrowser.data', function (jobs) {\n      viewModel.withActiveSnippet(function (snippet) {\n        if (!snippet || snippet.dialect() === DIALECT.impala) {\n          return;\n        }\n        if (jobs.length > 0) {\n          var progress = 0;\n          var parent;\n          jobs.forEach(function (job) {\n            var id = job.shortId || job.id;\n            var el = $('.jobs-overlay li:contains(' + id + ')');\n            if (!el.length) {\n              return;\n            }\n            var context = ko.contextFor(el[0]);\n            parent = context.$parent;\n            var _job = context.$data;\n            progress = parseInt(job.mapsPercentComplete);\n            if (isNaN(progress)) {\n              progress = parseInt(job.progress);\n            }\n            if (!isNaN(progress)) {\n              _job.percentJob(progress);\n            } else {\n              progress = 0;\n            }\n          });\n          if (parent && parent.jobs().length === 1) {\n            parent.progress(Math.max(progress, parent.progress()));\n          }\n        }\n      });\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('editor.get.active.risks', function (callback) {\n      var result = {\n        editor: undefined,\n        risks: {}\n      };\n      if (viewModel.selectedNotebook()) {\n        if (viewModel.selectedNotebook().snippets().length === 1) {\n          result.editor = viewModel.selectedNotebook().snippets()[0].ace();\n          result.risks = viewModel.selectedNotebook().snippets()[0].complexity() || {};\n        } else {\n          viewModel.selectedNotebook().snippets().every(function (snippet) {\n            if (snippet.inFocus()) {\n              result.editor = snippet.ace();\n              result.risks = snippet.complexity() || {};\n              return false;\n            }\n            return true;\n          });\n        }\n      }\n      callback(result);\n    }, HUE_PUB_SUB_EDITOR_ID);\n    huePubSub.subscribe('recalculate.name.description.width', function () {\n      waitForRendered('.editorComponents .hue-title-bar .query-name', function (el) {\n        return el.is(':visible');\n      }, function () {\n        var cumulativeWidth = 0;\n        $('.editorComponents .hue-title-bar ul li:not(.skip-width-calculation)').each(function () {\n          cumulativeWidth += $(this).outerWidth();\n        });\n        $('.notebook-name-desc').css('max-width', ($('.editorComponents .hue-title-bar').width() - cumulativeWidth - $('.editorComponents .hue-title-bar .pull-right').width() - 120) / 2 + 'px');\n      });\n    }, HUE_PUB_SUB_EDITOR_ID);\n    $(document).on('updateResultHeaders', function (e) {\n      huePubSub.publish(HIDE_FIXED_HEADERS_EVENT);\n      window.setTimeout(function () {\n        huePubSub.publish(REDRAW_FIXED_HEADERS_EVENT);\n      }, 200);\n    });\n    $(document).on('showAuthModal', function (e, data) {\n      viewModel.authSessionUsername(window.LOGGED_USERNAME);\n      viewModel.authSessionMessage(data['message']);\n      viewModel.authSessionPassword('');\n      viewModel.authSessionType(data['type']);\n      viewModel.authSessionCallback(data['callback']);\n      $('#authModal' + window.EDITOR_SUFFIX).modal('show');\n    });\n    $(document).on('hideHistoryModal', function (e) {\n      $('#clearHistoryModal' + window.EDITOR_SUFFIX).modal('hide');\n    });\n    $(document).on('editorSizeChanged', function () {\n      window.setTimeout(function () {\n        huePubSub.publish(REDRAW_CHART_EVENT);\n      }, 50);\n    });\n    $(document).on('redrawResults', function () {\n      window.setTimeout(function () {\n        huePubSub.publish(REDRAW_CHART_EVENT);\n      }, 50);\n    });\n    $(document).on('renderDataError', function (e, options) {\n      huePubSub.publish(SHOW_NORMAL_RESULT_EVENT);\n    });\n    var hideTimeout = -1;\n    $(document).on('hideAutocomplete', function () {\n      window.clearTimeout(hideTimeout);\n      hideTimeout = window.setTimeout(function () {\n        var $aceAutocomplete = $('.ace_editor.ace_autocomplete');\n        if ($aceAutocomplete.is(':visible')) {\n          $aceAutocomplete.hide();\n        }\n      }, 100);\n    });\n    $(window).on('resize', function () {\n      huePubSub.publish('recalculate.name.description.width');\n    });\n  }\n});","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n// Licensed to Cloudera, Inc. under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  Cloudera, Inc. licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport componentUtils from \"../../../ko/components/componentUtils\";\nimport DisposableComponent from \"../../../ko/components/DisposableComponent\";\nimport I18n from \"../../../utils/i18n\";\nexport var NAME = 'paginator';\n\n// prettier-ignore\nvar TEMPLATE = \"\\n<div class=\\\"pagination\\\" data-bind=\\\"visible: totalPages() > 1\\\" style=\\\"display: none;\\\">\\n  <ul>\\n    <li data-bind=\\\"css: { 'disabled' : currentPage() === 1 }\\\">\\n      <a href=\\\"javascript: void(0);\\\" data-bind=\\\"click: previousPage.bind($data)\\\">\".concat(I18n(\"Prev\"), \"</a>\\n    </li>\\n    <li class=\\\"active\\\"><span data-bind=\\\"text: currentPage() + '/' + totalPages()\\\"></span></li>\\n    <li data-bind=\\\"css: { 'disabled' : currentPage() === totalPages() }\\\">\\n      <a href=\\\"javascript: void(0);\\\" data-bind=\\\"click: nextPage.bind($data)\\\">\").concat(I18n(\"Next\"), \"</a>\\n    </li>\\n  </ul>\\n</div>\\n\");\nvar Paginator = /*#__PURE__*/function (_DisposableComponent) {\n  function Paginator(params, element) {\n    var _this;\n    _classCallCheck(this, Paginator);\n    _this = _callSuper(this, Paginator);\n    _this.totalPages = params.totalPages;\n    _this.currentPage = params.currentPage;\n    _this.onPageChange = params.onPageChange;\n    if (_this.onPageChange) {\n      _this.subscribe(_this.currentPage, _this.onPageChange);\n    }\n    return _this;\n  }\n  _inherits(Paginator, _DisposableComponent);\n  return _createClass(Paginator, [{\n    key: \"nextPage\",\n    value: function nextPage() {\n      if (this.currentPage() < this.totalPages()) {\n        this.currentPage(this.currentPage() + 1);\n      }\n    }\n  }, {\n    key: \"previousPage\",\n    value: function previousPage() {\n      if (this.currentPage() !== 1) {\n        this.currentPage(this.currentPage() - 1);\n      }\n    }\n  }]);\n}(DisposableComponent);\ncomponentUtils.registerComponent(NAME, Paginator, TEMPLATE);","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n// Licensed to Cloudera, Inc. under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  Cloudera, Inc. licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as ko from 'knockout';\nimport componentUtils from \"../../../ko/components/componentUtils\";\nimport DisposableComponent from \"../../../ko/components/DisposableComponent\";\nimport I18n from \"../../../utils/i18n\";\nimport { NAME as PAGINATOR_COMPONENT } from \"./ko.paginator\";\nimport apiHelper from \"../../../api/apiHelper\";\nimport { cancelActiveRequest } from \"../../../api/apiUtils\";\nexport var UPDATE_SAVED_QUERIES_EVENT = 'update.saved.queries';\nexport var NAME = 'saved-queries';\n\n// prettier-ignore\nvar TEMPLATE = \"\\n<div class=\\\"snippet-tab-actions\\\">\\n  <form autocomplete=\\\"off\\\" class=\\\"inline-block\\\">\\n    <input class=\\\"input-small search-input\\\" type=\\\"text\\\" \".concat(window.PREVENT_AUTOFILL_INPUT_ATTRS, \" placeholder=\\\"\").concat(I18n('Search...'), \"\\\" data-bind=\\\"\\n        textInput: filter,\\n        clearable: filter\\n      \\\"/>\\n  </form>\\n</div>\\n\\n<div class=\\\"snippet-tab-body\\\">\\n  <!-- ko if: loading -->\\n    <div>\\n      <h1 class=\\\"empty\\\"><i class=\\\"fa fa-spinner fa-spin\\\"></i> \").concat(I18n('Loading...'), \"</h1>\\n    </div>\\n  <!-- /ko -->\\n\\n  <!-- ko ifnot: loading -->\\n    <!-- ko if: hasErrors -->\\n      <div class=\\\"margin-top-10 margin-left-10\\\" style=\\\"font-style: italic\\\">\").concat(I18n(\"Error loading the queries.\"), \"</div>\\n    <!-- /ko -->\\n    <!-- ko if: !hasErrors() && !loading() && queries().length === 0 && filter() === '' -->\\n      <div class=\\\"margin-top-10 margin-left-10\\\" style=\\\"font-style: italic\\\">\").concat(I18n(\"You don't have any saved queries.\"), \"</div>\\n    <!-- /ko -->\\n    <!-- ko if: !hasErrors() && !loading() && queries().length === 0 && filter() !== '' -->\\n      <div class=\\\"margin-top-10 margin-left-10\\\" style=\\\"font-style: italic\\\">\").concat(I18n('No queries found for'), \" <strong data-bind=\\\"text: filter\\\"></strong>.</div>\\n    <!-- /ko -->\\n    <!-- ko if: !hasErrors() && !loading() && queries().length > 0 -->\\n      <table class=\\\"table table-condensed margin-top-10 history-table\\\">\\n        <thead>\\n        <tr>\\n          <th style=\\\"width: 16%\\\">\").concat(I18n(\"Name\"), \"</th>\\n          <th style=\\\"width: 50%\\\">\").concat(I18n(\"Description\"), \"</th>\\n          <th style=\\\"width: 18%\\\">\").concat(I18n(\"Owner\"), \"</th>\\n          <th style=\\\"width: 16%\\\">\").concat(I18n(\"Last Modified\"), \"</th>\\n        </tr>\\n        </thead>\\n        <tbody data-bind=\\\"foreach: queries\\\">\\n        <tr data-bind=\\\"\\n            click: function() {\\n              $parent.openNotebook(uuid);\\n            },\\n            css: {\\n              'highlight': uuid == $parent.currentNotebook.uuid(),\\n              'pointer': uuid != $parent.currentNotebook.uuid()\\n            }\\\">\\n          <td style=\\\"width: 16%\\\"><span data-bind=\\\"ellipsis: { data: name, length: 50 }\\\"></span></td>\\n          <td style=\\\"width: 50%; white-space: normal\\\"><span data-bind=\\\"text: description\\\"></span></td>\\n          <td style=\\\"width: 18%\\\"><span data-bind=\\\"text: owner\\\"></span></td>\\n          <td style=\\\"width: 16%\\\"><span data-bind=\\\"text: localeFormat(lastModified())\\\"></span></td>\\n        </tr>\\n        </tbody>\\n      </table>\\n    <!-- /ko -->\\n\\n    <!-- ko component: {\\n      name: '\").concat(PAGINATOR_COMPONENT, \"',\\n      params: {\\n        currentPage: currentPage,\\n        totalPages: totalPages,\\n        onPageChange: fetchQueries.bind($data)\\n      }\\n    } --><!-- /ko -->\\n  <!-- /ko -->\\n</div>\\n\");\nvar QUERIES_PER_PAGE = 50;\nvar adaptRawQuery = function adaptRawQuery(rawQuery) {\n  return {\n    uuid: rawQuery.uuid,\n    name: ko.observable(rawQuery.name),\n    owner: rawQuery.owner,\n    description: ko.observable(rawQuery.description),\n    lastModified: ko.observable(rawQuery.last_modified)\n  };\n};\nvar SavedQueries = /*#__PURE__*/function (_DisposableComponent) {\n  function SavedQueries(params) {\n    var _this;\n    _classCallCheck(this, SavedQueries);\n    _this = _callSuper(this, SavedQueries);\n    _this.currentNotebook = params.currentNotebook;\n    _this.openFunction = params.openFunction;\n    _this.dialect = params.dialect;\n    _this.currentTab = params.currentTab;\n    _this.loading = ko.observable(true);\n    _this.hasErrors = ko.observable(false);\n    _this.queries = ko.observableArray();\n    _this.currentPage = ko.observable(1);\n    _this.totalPages = ko.observable(1);\n    _this.lastFetchQueriesRequest = undefined;\n    _this.filter = ko.observable().extend({\n      rateLimit: 900\n    });\n    _this.filter.subscribe(function () {\n      _this.fetchQueries();\n    });\n    _this.subscribe(UPDATE_SAVED_QUERIES_EVENT, function (details) {\n      if (!details.save_as) {\n        _this.queries().some(function (item) {\n          if (item.uuid === details.uuid) {\n            item.name(details.name);\n            item.description(details.description);\n            item.lastModified(details.last_modified);\n            return true;\n          }\n        });\n      } else if (_this.queries().length) {\n        _this.queries.unshift(adaptRawQuery(details));\n      } else {\n        _this.fetchQueries();\n      }\n    });\n    if (_this.currentTab() === 'savedQueries') {\n      _this.fetchQueries();\n    } else {\n      var sub = _this.subscribe(_this.currentTab, function (tab) {\n        if (tab === 'savedQueries') {\n          _this.fetchQueries();\n          sub.dispose();\n        }\n      });\n    }\n    return _this;\n  }\n  _inherits(SavedQueries, _DisposableComponent);\n  return _createClass(SavedQueries, [{\n    key: \"fetchQueries\",\n    value: function () {\n      var _fetchQueries = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var _this2 = this;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              cancelActiveRequest(this.lastFetchQueriesRequest);\n              this.loading(true);\n              this.hasErrors(false);\n              this.lastFetchQueriesRequest = apiHelper.searchDocuments({\n                successCallback: function successCallback(foundDocuments) {\n                  _this2.totalPages(Math.ceil(foundDocuments.count / QUERIES_PER_PAGE));\n                  _this2.queries(foundDocuments.documents.map(adaptRawQuery));\n                  _this2.loading(false);\n                  _this2.hasErrors(false);\n                },\n                errorCallback: function errorCallback() {\n                  _this2.loading(false);\n                  _this2.hasErrors(true);\n                },\n                page: this.currentPage(),\n                limit: QUERIES_PER_PAGE,\n                type: 'query-' + this.dialect(),\n                query: this.filter(),\n                include_trashed: false\n              });\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function fetchQueries() {\n        return _fetchQueries.apply(this, arguments);\n      }\n      return fetchQueries;\n    }()\n  }, {\n    key: \"openNotebook\",\n    value: function openNotebook(uuid) {\n      if (window.getSelection().toString() === '' && uuid !== this.currentNotebook.uuid()) {\n        this.openFunction(uuid);\n      }\n    }\n  }]);\n}(DisposableComponent);\ncomponentUtils.registerComponent(NAME, SavedQueries, TEMPLATE);","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n// Licensed to Cloudera, Inc. under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  Cloudera, Inc. licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport $ from 'jquery';\nimport * as ko from 'knockout';\nimport komapping from 'knockout.mapping';\nimport apiHelper from \"../../api/apiHelper\";\nimport hueAnalytics from 'utils/hueAnalytics';\nimport huePubSub from 'utils/huePubSub';\nimport UUID from 'utils/string/UUID';\nimport sessionManager from 'apps/editor/execution/sessionManager';\nimport Snippet, { STATUS as SNIPPET_STATUS } from \"./snippet\";\nimport { UPDATE_SAVED_QUERIES_EVENT } from \"./components/ko.savedQueries\";\nimport { ASSIST_DB_PANEL_IS_READY_EVENT, ASSIST_IS_DB_PANEL_READY_EVENT, ASSIST_SET_DATABASE_EVENT } from \"../../ko/components/assist/events\";\nimport { GLOBAL_ERROR_TOPIC, GLOBAL_INFO_TOPIC } from 'reactComponents/AlertComponent/events';\nvar HISTORY_CLEARED_EVENT = 'query.history.cleared';\nvar Notebook = /*#__PURE__*/function () {\n  function Notebook(vm, notebookRaw) {\n    var _this = this;\n    _classCallCheck(this, Notebook);\n    this.parentVm = vm;\n    this.id = ko.observable(notebookRaw.id);\n    this.uuid = ko.observable(notebookRaw.uuid || UUID());\n    this.name = ko.observable(notebookRaw.name || '');\n    this.description = ko.observable(notebookRaw.description || '');\n    this.type = ko.observable(notebookRaw.type || 'notebook');\n    this.initialType = this.type().replace('query-', '');\n    this.coordinatorUuid = ko.observable(notebookRaw.coordinatorUuid);\n    this.isHistory = ko.observable(!!notebookRaw.is_history);\n    this.isManaged = ko.observable(!!notebookRaw.isManaged);\n    this.parentSavedQueryUuid = ko.observable(notebookRaw.parentSavedQueryUuid); // History parent\n    this.isSaved = ko.observable(!!notebookRaw.isSaved);\n    this.canWrite = ko.observable(notebookRaw.can_write !== false);\n    this.onSuccessUrl = ko.observable(notebookRaw.onSuccessUrl);\n    this.pubSubUrl = ko.observable(notebookRaw.pubSubUrl);\n    this.isPresentationModeDefault = ko.observable(!!notebookRaw.isPresentationModeDefault);\n    this.isPresentationMode = ko.observable(false);\n    this.isHidingCode = ko.observable(!!notebookRaw.isHidingCode);\n    this.snippets = ko.observableArray();\n    this.selectedSnippet = ko.observable(vm.editorType()); // Aka selectedSnippetType\n    this.directoryUuid = ko.observable(notebookRaw.directoryUuid);\n    this.dependents = komapping.fromJS(notebookRaw.dependents || []);\n    this.dependentsCoordinator = ko.pureComputed(function () {\n      return _this.dependents().filter(function (doc) {\n        return doc.type() === 'oozie-coordinator2' && doc.is_managed();\n      });\n    });\n    if (this.dependentsCoordinator().length > 0 && !this.coordinatorUuid()) {\n      this.coordinatorUuid(this.dependentsCoordinator()[0].uuid());\n    }\n    this.history = ko.observableArray(vm.selectedNotebook() && vm.selectedNotebook().history().length > 0 && vm.selectedNotebook().history()[0].type === this.type() ? vm.selectedNotebook().history() : []);\n    this.schedulerViewModel = null;\n    this.schedulerViewModelIsLoaded = ko.observable(false);\n    this.schedulerViewerViewModel = ko.observable();\n    this.isBatchable = ko.pureComputed(function () {\n      return _this.snippets().length > 0 && _this.snippets().every(function (snippet) {\n        return snippet.isBatchable();\n      });\n    });\n    this.isExecutingAll = ko.observable(!!notebookRaw.isExecutingAll);\n    this.executingAllIndex = ko.observable(notebookRaw.executingAllIndex || 0);\n    this.retryModalConfirm = null;\n    this.retryModalCancel = null;\n    this.avoidClosing = false;\n    this.canSave = vm.canSave;\n    this.unloaded = ko.observable(false);\n    this.viewSchedulerId = ko.observable(notebookRaw.viewSchedulerId || '');\n    this.viewSchedulerId.subscribe(function () {\n      _this.save();\n    });\n    this.isSchedulerJobRunning = ko.observable();\n    this.loadingScheduler = ko.observable(false);\n\n    // Init\n    if (notebookRaw.snippets) {\n      notebookRaw.snippets.forEach(function (snippetRaw) {\n        _this.addSnippet(snippetRaw);\n      });\n    }\n    huePubSub.subscribe(HISTORY_CLEARED_EVENT, function () {\n      if (_this.isHistory()) {\n        _this.id(null);\n        _this.uuid(UUID());\n        _this.parentVm.changeURL(_this.parentVm.URLS.editor + '?type=' + _this.parentVm.editorType());\n      }\n    });\n    huePubSub.subscribeOnce(ASSIST_DB_PANEL_IS_READY_EVENT, function () {\n      if (_this.type().indexOf('query') === 0) {\n        var whenDatabaseAvailable = function whenDatabaseAvailable(snippet) {\n          huePubSub.publish(ASSIST_SET_DATABASE_EVENT, {\n            connector: snippet.connector(),\n            namespace: snippet.namespace(),\n            name: snippet.database()\n          });\n        };\n        var whenNamespaceAvailable = function whenNamespaceAvailable(snippet) {\n          if (snippet.database()) {\n            whenDatabaseAvailable(snippet);\n          } else {\n            var databaseSub = snippet.database.subscribe(function () {\n              databaseSub.dispose();\n              whenDatabaseAvailable(snippet);\n            });\n          }\n        };\n        var whenSnippetAvailable = function whenSnippetAvailable(snippet) {\n          if (snippet.namespace()) {\n            whenNamespaceAvailable(snippet);\n          } else {\n            var namespaceSub = snippet.namespace.subscribe(function () {\n              namespaceSub.dispose();\n              whenNamespaceAvailable(snippet);\n            });\n          }\n        };\n        if (_this.snippets().length === 1) {\n          whenSnippetAvailable(_this.snippets()[0]);\n        } else {\n          var snippetsSub = _this.snippets.subscribe(function (snippets) {\n            if (snippets.length === 1) {\n              whenSnippetAvailable(snippets[0]);\n            }\n            snippetsSub.dispose();\n          });\n        }\n      }\n    }, vm.huePubSubId);\n    huePubSub.publish(ASSIST_IS_DB_PANEL_READY_EVENT);\n  }\n  return _createClass(Notebook, [{\n    key: \"addSnippet\",\n    value: function addSnippet(snippetRaw) {\n      var newSnippet = new Snippet(this.parentVm, this, snippetRaw);\n      this.snippets.push(newSnippet);\n      newSnippet.init();\n      return newSnippet;\n    }\n  }, {\n    key: \"clearResults\",\n    value: function clearResults() {\n      this.snippets().forEach(function (snippet) {\n        snippet.result.clear();\n        snippet.status(SNIPPET_STATUS.ready);\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function () {\n      var _close = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              hueAnalytics.log('notebook', 'close');\n              _context.t0 = apiHelper;\n              _context.next = 4;\n              return this.toJson();\n            case 4:\n              _context.t1 = _context.sent;\n              _context.t2 = this.parentVm.editorMode();\n              _context.t3 = {\n                notebookJson: _context.t1,\n                editorMode: _context.t2\n              };\n              _context.t0.closeNotebook.call(_context.t0, _context.t3);\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function close() {\n        return _close.apply(this, arguments);\n      }\n      return close;\n    }()\n  }, {\n    key: \"executeAll\",\n    value: function executeAll() {\n      if (this.isExecutingAll() || this.snippets().length === 0) {\n        return;\n      }\n      this.isExecutingAll(true);\n      this.executingAllIndex(0);\n      this.snippets()[this.executingAllIndex()].execute();\n    }\n  }, {\n    key: \"getSnippets\",\n    value: function getSnippets(type) {\n      return this.snippets().filter(function (snippet) {\n        return snippet.dialect() === type;\n      });\n    }\n  }, {\n    key: \"loadScheduler\",\n    value: function loadScheduler() {\n      var _this2 = this;\n      if (typeof this.parentVm.CoordinatorEditorViewModel !== 'undefined' && this.isBatchable()) {\n        var action;\n        if (this.coordinatorUuid()) {\n          action = 'edit';\n        } else {\n          action = 'new';\n        }\n        hueAnalytics.log('notebook', 'schedule/' + action);\n        var getCoordinator = function getCoordinator() {\n          $.get('/scheduler/api/schedule/' + action + '/', {\n            format: 'json',\n            document: _this2.uuid(),\n            coordinator: _this2.coordinatorUuid()\n          }, function (data) {\n            if ($('#schedulerEditor').length > 0) {\n              huePubSub.publish('hue4.process.headers', {\n                response: data.layout,\n                callback: function callback(r) {\n                  var $schedulerEditor = $('#schedulerEditor');\n                  $schedulerEditor.html(r);\n                  _this2.schedulerViewModel = new _this2.parentVm.CoordinatorEditorViewModel(data.coordinator, data.credentials, data.workflows, data.can_edit);\n                  ko.cleanNode($schedulerEditor[0]);\n                  ko.applyBindings(_this2.schedulerViewModel, $schedulerEditor[0]);\n                  $(document).off('showSubmitPopup');\n                  $(document).on('showSubmitPopup', function (event, data) {\n                    var $submitModalEditor = $('.submit-modal-editor');\n                    $submitModalEditor.html(data);\n                    $submitModalEditor.modal('show');\n                    $submitModalEditor.on('hidden', function () {\n                      huePubSub.publish('hide.datepicker');\n                    });\n                    var _sel = $('.submit-form .control-group[rel!=\"popover\"]:visible');\n                    if (_sel.length > 0) {\n                      var $submitModalEditorBody = $('.submit-modal-editor .modal-body');\n                      $submitModalEditorBody.height($submitModalEditorBody.height() + 60);\n                    }\n                  });\n                  huePubSub.publish('render.jqcron');\n                  _this2.schedulerViewModel.coordinator.properties.cron_advanced.valueHasMutated(); // Update jsCron enabled status\n                  _this2.schedulerViewModel.coordinator.tracker().markCurrentStateAsClean();\n                  _this2.schedulerViewModel.isEditing(true);\n                  _this2.schedulerViewModelIsLoaded(true);\n                  if (action === 'new') {\n                    _this2.schedulerViewModel.coordinator.properties.document(_this2.uuid()); // Expected for triggering the display\n                  }\n                }\n              });\n            }\n          }).fail(function (xhr) {\n            if (xhr.status !== 502) {\n              huePubSub.publish(GLOBAL_ERROR_TOPIC, {\n                message: xhr.responseText\n              });\n            }\n          });\n        };\n        getCoordinator();\n      }\n    }\n  }, {\n    key: \"newSnippet\",\n    value: function newSnippet(type) {\n      if (type) {\n        this.selectedSnippet(type);\n      }\n      var snippet = this.addSnippet({\n        type: this.selectedSnippet(),\n        result: {}\n      });\n      window.setTimeout(function () {\n        var lastSnippet = snippet;\n        if (lastSnippet.ace() != null) {\n          lastSnippet.ace().focus();\n        }\n      }, 100);\n      hueAnalytics.log('notebook', 'add_snippet/' + (type ? type : this.selectedSnippet()));\n      return snippet;\n    }\n  }, {\n    key: \"newSnippetAbove\",\n    value: function newSnippetAbove(id) {\n      this.newSnippet();\n      var idx = 0;\n      this.snippets().forEach(function (snippet, cnt) {\n        if (snippet.id() === id) {\n          idx = cnt;\n        }\n      });\n      this.snippets(this.snippets().move(this.snippets().length - 1, idx));\n    }\n  }, {\n    key: \"save\",\n    value: function () {\n      var _save = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(callback) {\n        var editorMode, data, wasHistory;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              hueAnalytics.log('notebook', 'save');\n              editorMode = this.parentVm.editorMode() || this.isPresentationMode() && this.parentVm.editorType() !== 'notebook'; // Editor should not convert to Notebook in presentation mode\n              _context2.prev = 2;\n              _context2.t0 = apiHelper;\n              _context2.next = 6;\n              return this.toJson();\n            case 6:\n              _context2.t1 = _context2.sent;\n              _context2.t2 = editorMode;\n              _context2.t3 = {\n                notebookJson: _context2.t1,\n                editorMode: _context2.t2\n              };\n              _context2.next = 11;\n              return _context2.t0.saveNotebook.call(_context2.t0, _context2.t3);\n            case 11:\n              data = _context2.sent;\n              if (data.status === 0) {\n                this.id(data.id);\n                this.isSaved(true);\n                wasHistory = this.isHistory();\n                this.isHistory(false);\n                huePubSub.publish(GLOBAL_INFO_TOPIC, {\n                  message: data.message\n                });\n                if (editorMode) {\n                  huePubSub.publish(UPDATE_SAVED_QUERIES_EVENT, data);\n                  if (data.save_as) {\n                    huePubSub.publish('assist.document.refresh');\n                  }\n                  if (this.coordinatorUuid() && this.schedulerViewModel) {\n                    this.saveScheduler();\n                    this.schedulerViewModel.coordinator.refreshParameters();\n                  }\n                  if (wasHistory || data.save_as) {\n                    this.loadScheduler();\n                  }\n                  if (this.snippets()[0].downloadResultViewModel && this.snippets()[0].downloadResultViewModel().saveTarget() === 'dashboard') {\n                    huePubSub.publish('open.link', this.parentVm.URLS.report + '&uuid=' + data.uuid + '&statement=' + this.snippets()[0].result.handle().statement_id);\n                  } else {\n                    this.parentVm.changeURL(this.parentVm.URLS.editor + '?editor=' + data.id);\n                  }\n                } else {\n                  this.parentVm.changeURL(this.parentVm.URLS.notebook + '?notebook=' + data.id);\n                }\n                if (typeof callback == 'function') {\n                  callback();\n                }\n              } else {\n                huePubSub.publish(GLOBAL_ERROR_TOPIC, {\n                  message: data.message\n                });\n              }\n              _context2.next = 19;\n              break;\n            case 15:\n              _context2.prev = 15;\n              _context2.t4 = _context2[\"catch\"](2);\n              console.error(_context2.t4);\n              if (_context2.t4 && _context2.t4.status !== 502) {\n                huePubSub.publish(GLOBAL_ERROR_TOPIC, {\n                  message: _context2.t4.responseText\n                });\n              }\n            case 19:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[2, 15]]);\n      }));\n      function save(_x) {\n        return _save.apply(this, arguments);\n      }\n      return save;\n    }()\n  }, {\n    key: \"saveScheduler\",\n    value: function saveScheduler() {\n      var _this3 = this;\n      if (this.isBatchable() && (!this.coordinatorUuid() || this.schedulerViewModel.coordinator.isDirty())) {\n        this.schedulerViewModel.coordinator.isManaged(true);\n        this.schedulerViewModel.coordinator.properties.document(this.uuid());\n        this.schedulerViewModel.save(function (data) {\n          if (!_this3.coordinatorUuid()) {\n            _this3.coordinatorUuid(data.uuid);\n            _this3.save();\n          }\n        });\n      }\n    }\n  }, {\n    key: \"showSubmitPopup\",\n    value: function showSubmitPopup() {\n      $.get('/scheduler/api/submit/' + this.coordinatorUuid(), {\n        format: 'json'\n      }, function (data) {\n        $(document).trigger('showSubmitPopup', data);\n      }).fail(function (xhr) {\n        if (xhr.status !== 502) {\n          huePubSub.publish(GLOBAL_ERROR_TOPIC, {\n            message: xhr.responseText\n          });\n        }\n      });\n    }\n  }, {\n    key: \"toContextJson\",\n    value: function () {\n      var _toContextJson = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.t0 = JSON;\n              _context3.t1 = this.id();\n              _context3.t2 = this.isSaved();\n              _context3.t3 = this.name();\n              _context3.t4 = this.parentSavedQueryUuid();\n              _context3.next = 7;\n              return sessionManager.getAllSessions();\n            case 7:\n              _context3.t5 = _context3.sent;\n              _context3.t6 = this.type();\n              _context3.t7 = this.uuid();\n              _context3.t8 = {\n                id: _context3.t1,\n                isSaved: _context3.t2,\n                name: _context3.t3,\n                parentSavedQueryUuid: _context3.t4,\n                sessions: _context3.t5,\n                type: _context3.t6,\n                uuid: _context3.t7\n              };\n              return _context3.abrupt(\"return\", _context3.t0.stringify.call(_context3.t0, _context3.t8));\n            case 12:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function toContextJson() {\n        return _toContextJson.apply(this, arguments);\n      }\n      return toContextJson;\n    }()\n  }, {\n    key: \"toJs\",\n    value: function () {\n      var _toJs = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.t0 = this.coordinatorUuid();\n              _context4.t1 = this.description();\n              _context4.t2 = this.directoryUuid();\n              _context4.t3 = this.executingAllIndex();\n              _context4.t4 = this.id();\n              _context4.t5 = this.isExecutingAll();\n              _context4.t6 = this.isHidingCode();\n              _context4.t7 = this.isHistory();\n              _context4.t8 = this.isManaged();\n              _context4.t9 = this.isPresentationModeDefault();\n              _context4.t10 = this.isSaved();\n              _context4.t11 = this.name();\n              _context4.t12 = this.onSuccessUrl();\n              _context4.t13 = this.parentSavedQueryUuid();\n              _context4.t14 = this.pubSubUrl();\n              _context4.t15 = {};\n              _context4.next = 18;\n              return sessionManager.getAllSessions();\n            case 18:\n              _context4.t16 = _context4.sent;\n              _context4.t17 = this.snippets().map(function (snippet) {\n                return snippet.toJs();\n              });\n              _context4.t18 = this.type();\n              _context4.t19 = this.uuid();\n              _context4.t20 = this.viewSchedulerId();\n              return _context4.abrupt(\"return\", {\n                coordinatorUuid: _context4.t0,\n                description: _context4.t1,\n                directoryUuid: _context4.t2,\n                executingAllIndex: _context4.t3,\n                id: _context4.t4,\n                isExecutingAll: _context4.t5,\n                isHidingCode: _context4.t6,\n                isHistory: _context4.t7,\n                isManaged: _context4.t8,\n                isPresentationModeDefault: _context4.t9,\n                isSaved: _context4.t10,\n                name: _context4.t11,\n                onSuccessUrl: _context4.t12,\n                parentSavedQueryUuid: _context4.t13,\n                pubSubUrl: _context4.t14,\n                result: _context4.t15,\n                sessions: _context4.t16,\n                snippets: _context4.t17,\n                type: _context4.t18,\n                uuid: _context4.t19,\n                viewSchedulerId: _context4.t20\n              });\n            case 24:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function toJs() {\n        return _toJs.apply(this, arguments);\n      }\n      return toJs;\n    }()\n  }, {\n    key: \"toJson\",\n    value: function () {\n      var _toJson = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.t0 = JSON;\n              _context5.next = 3;\n              return this.toJs();\n            case 3:\n              _context5.t1 = _context5.sent;\n              return _context5.abrupt(\"return\", _context5.t0.stringify.call(_context5.t0, _context5.t1));\n            case 5:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function toJson() {\n        return _toJson.apply(this, arguments);\n      }\n      return toJson;\n    }()\n  }, {\n    key: \"unload\",\n    value: function unload() {\n      this.unloaded(true);\n      var currentQueries = null;\n      this.snippets().forEach(function (snippet) {\n        if (snippet.checkStatusTimeout != null) {\n          clearTimeout(snippet.checkStatusTimeout);\n          snippet.checkStatusTimeout = null;\n        }\n        if (currentQueries == null) {\n          currentQueries = snippet.queries();\n        }\n      });\n      return currentQueries;\n    }\n  }]);\n}();\nexport { Notebook as default };"],"names":[],"sourceRoot":""}